<!DOCTYPE html>
<html lang="id" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <meta name="google" content="notranslate">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>HSK 3 Â· ç¬¬18è¯¾ Â· æˆ‘ç›¸ä¿¡ä»–ä»¬ä¼šåŒæ„çš„ Â· ç‰ˆæœ¬2</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        input, textarea, .btn-opsi, .btn-pilih, .btn-bs, .btn-kata,
        .pair-item-left, .pair-item-right, .btn-utama, .btn-review {
            -webkit-user-select: auto;
            -khtml-user-select: auto;
            -moz-user-select: auto;
            -ms-user-select: auto;
            user-select: auto;
        }
        body {
            -webkit-touch-callout: none;
            background: linear-gradient(145deg, #e0f2fe 0%, #bae6fd 100%);
            background-attachment: fixed;
            padding: 30px 20px;
            color: #1e3a5f;
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            min-height: 100vh;
        }
        .pokemon-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #facc15 0%, #eab308 100%);
            padding: 18px 30px;
            border-radius: 60px 60px 30px 30px;
            box-shadow: 0 10px 0 #b45309, 0 8px 20px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            border: 3px solid #2d1b0e;
            color: #0f172a;
            flex-wrap: wrap;
        }
        .pokemon-header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            text-shadow: 3px 3px 0 #ffedd5;
            letter-spacing: 2px;
            margin: 0;
        }
        .pokemon-header i {
            font-size: 3rem;
            color: #ffde00;
            text-shadow: 2px 2px 0 #2d1b0e;
        }
        .timer-container {
            background: #1e293b;
            border-radius: 60px;
            padding: 15px 30px;
            margin: 0 0 30px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 4px solid #fde047;
            color: white;
            font-weight: 700;
            font-size: 1.8rem;
            box-shadow: 8px 8px 0 #0f172a;
            flex-wrap: wrap;
        }
        .timer-box {
            background: #dc2626;
            padding: 10px 25px;
            border-radius: 50px;
            border: 3px solid #fde047;
            color: white;
            font-family: monospace;
            letter-spacing: 5px;
        }
        .section-card {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(8px);
            border: 5px solid #2563eb;
            border-radius: 50px 20px 50px 20px;
            box-shadow: 12px 12px 0 #1e40af, 0 12px 25px rgba(0,0,0,0.2);
            padding: 30px 25px;
            margin-bottom: 50px;
        }
        .section-title {
            background: linear-gradient(145deg, #dc2626, #ef4444);
            display: inline-block;
            padding: 12px 35px;
            border-radius: 40px 10px 40px 10px;
            color: white;
            font-weight: 700;
            font-size: 1.7rem;
            margin-top: -60px;
            margin-bottom: 25px;
            border: 4px solid #fde047;
            box-shadow: 6px 6px 0 #854d0e;
            text-shadow: 2px 2px 0 #3d2b1a;
        }
        .section-title i {
            margin-right: 15px;
            color: #fde047;
        }
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        .soal-item {
            background: white;
            padding: 18px 20px;
            border-radius: 25px 8px 25px 8px;
            border: 3px solid #6b5a9c;
            box-shadow: 7px 7px 0 #4a3b6b;
            margin-bottom: 20px;
        }
        .benar-salah-container {
            display: flex;
            gap: 20px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        .btn-bs {
            background: #f2f2f2;
            border: 3px solid #444;
            padding: 10px 25px;
            border-radius: 40px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.1s;
            box-shadow: 4px 4px 0 #888;
        }
        .btn-bs.selected { background: #90caf9; border-color: #0d47a1; box-shadow: 2px 2px 0 #0d2c4a; color: #0d1f3a; }
        .btn-bs.benar { background: #3acf3a !important; border-color: #1f7a1f !important; color: white; box-shadow: 2px 2px 0 #0a3b0a; }
        .btn-bs.salah { background: #ff5e5e !important; border-color: #a00000 !important; color: white; box-shadow: 2px 2px 0 #5a0000; }
        .dialog-box {
            background: #fef9c3;
            padding: 12px;
            border-radius: 20px;
            border: 2px solid #b45309;
            margin-bottom: 12px;
        }
        .dialog-line { font-size: 1.2rem; margin: 5px 0; }
        .pertanyaan { font-size: 1.2rem; font-weight: 700; margin: 12px 0 8px; }
        .opsi-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px; }
        .btn-opsi {
            background: #f2f2f2; border: 3px solid #444; padding: 10px 15px; border-radius: 30px;
            font-weight: 600; cursor: pointer; transition: 0.1s; box-shadow: 3px 3px 0 #888; text-align: left;
        }
        .btn-opsi.selected { background: #90caf9; border-color: #0d47a1; box-shadow: 2px 2px 0 #0d2c4a; color: #0d1f3a; }
        .btn-opsi.benar { background: #3acf3a !important; border-color: #1f7a1f !important; color: white; box-shadow: 2px 2px 0 #0a3b0a; }
        .btn-opsi.salah { background: #ff5e5e !important; border-color: #a00000 !important; color: white; box-shadow: 2px 2px 0 #5a0000; }
        .btn-pilih {
            background: #f2f2f2; border: 3px solid #444; padding: 12px 25px; border-radius: 30px;
            font-weight: 700; cursor: pointer; transition: 0.1s; box-shadow: 4px 4px 0 #888;
        }
        .btn-pilih.selected { background: #90caf9; border-color: #0d47a1; box-shadow: 2px 2px 0 #0d2c4a; color: #0d1f3a; }
        .btn-pilih.benar { background: #3acf3a !important; border-color: #1f7a1f !important; color: white; box-shadow: 2px 2px 0 #0a3b0a; }
        .btn-pilih.salah { background: #ff5e5e !important; border-color: #a00000 !important; color: white; box-shadow: 2px 2px 0 #5a0000; }
        .input-kotak {
            background: white; border: 4px solid #7b3f00; border-radius: 20px; padding: 10px 20px;
            font-size: 1.5rem; text-align: center; width: 100%; letter-spacing: 8px;
            font-weight: 600; color: #1e3a5f; box-shadow: inset 3px 3px 0 #bbb;
        }
        .input-kotak.benar { background: #a5d6a5; border-color: #1f7a1f; }
        .input-kotak.salah { background: #ffab91; border-color: #b71c1c; }
        .bank-kata-container {
            background: #fef3c7; border: 5px dashed #b45309; border-radius: 50px; 
            padding: 20px; margin-bottom: 30px; display: flex; flex-wrap: wrap; gap: 12px;
            align-items: center; justify-content: center;
        }
        .btn-kata {
            background: #ffcb05; border: 3px solid #2d70b0; padding: 10px 25px;
            border-radius: 40px; font-size: 1.4rem; font-weight: 700; color: #1f3c7a;
            box-shadow: 5px 5px 0 #1f4f8a; cursor: pointer; transition: 0.05s;
        }
        .btn-kata:active { transform: scale(0.95); box-shadow: 2px 2px 0 #1f4f8a; }
        .soal-isian {
            background: #f1f8e9; border: 4px solid #558b2f; border-radius: 30px 10px 30px 10px;
            padding: 20px; box-shadow: 8px 8px 0 #33691e;
        }
        .soal-isian p { font-size: 1.3rem; font-weight: 600; margin-bottom: 15px; }
        .pasangan-container { display: flex; justify-content: space-between; gap: 30px; margin-top: 20px; }
        .kolom-pasangan { 
            background: #a1d6e2; border-radius: 25px; padding: 20px; flex: 1; border: 4px solid #1f7a7a; 
            min-height: 350px; position: relative;
        }
        .pair-item-left, .pair-item-right {
            background: #fef9d9; padding: 15px 20px; margin: 12px 0;
            border-radius: 40px 8px 40px 8px; border: 3px solid #b98229;
            font-weight: 600; box-shadow: 5px 5px 0 #7c5e1a; cursor: pointer;
            transition: 0.1s; position: relative;
        }
        .pair-item-left {
            cursor: grab;
            touch-action: none;
            -webkit-touch-action: none;
        }
        .pair-item-left.dragging {
            opacity: 0.6;
            box-shadow: 0 0 0 3px #2563eb;
            cursor: grabbing;
        }
        .pair-item-left.paired, .pair-item-right.paired { 
            background: #b8e2f2 !important; 
            border-color: #0f6e8a !important; 
            box-shadow: 2px 2px 0 #0a495a;
            color: #042431;
        }
        .pair-item-left.benar, .pair-item-right.benar { background: #a5d6a5 !important; border-color: #1f7a1f !important; }
        .pair-item-left.salah, .pair-item-right.salah { background: #ffab91 !important; border-color: #b71c1c !important; }
        .drag-ghost {
            position: fixed; 
            background: #ffcb05; 
            padding: 15px 25px;
            border-radius: 40px 8px 40px 8px; 
            border: 3px solid #2d70b0;
            font-weight: 700; 
            color: #1f3c7a; 
            box-shadow: 8px 8px 0 #1f4f8a;
            pointer-events: none; 
            z-index: 9999; 
            transform: translate(-50%, -50%);
            opacity: 0.9; 
            white-space: nowrap;
            display: none;
        }
        .btn-utama {
            background: #dc2626; border: none; color: white; padding: 20px 70px;
            font-size: 2rem; border-radius: 80px; font-weight: 700; border-bottom: 10px solid #991b1b;
            margin: 40px auto; cursor: pointer; display: block; transition: 0.05s linear;
        }
        .btn-utama:active { border-bottom-width: 4px; transform: translateY(6px); }
        .btn-review {
            background: #2563eb; border: none; color: white; padding: 15px 50px;
            font-size: 1.8rem; border-radius: 60px; font-weight: 700; border-bottom: 8px solid #1e40af;
            margin: 20px auto; cursor: pointer; display: inline-block; transition: 0.05s linear;
        }
        .btn-review:active { border-bottom-width: 3px; transform: translateY(5px); }
        .laporan-akhir {
            background: #0f172a; color: white; padding: 30px; border-radius: 60px 20px 60px 20px;
            margin-top: 30px; font-size: 1.5rem; border: 6px solid #facc15; text-align: center;
        }
        footer { text-align: center; margin-top: 40px; font-size: 1.3rem; color: #1e3a5f; font-weight: 700; }
        @media (max-width: 900px) {
            .grid-2 { grid-template-columns: 1fr; }
            .pokemon-header h1 { font-size: 1.8rem; }
            .timer-container { font-size: 1.4rem; }
            .timer-box { padding: 8px 20px; }
            .section-title { font-size: 1.4rem; padding: 10px 25px; }
        }
        @media (max-width: 480px) {
            body { padding: 20px 10px; }
            .btn-utama { padding: 15px 30px; font-size: 1.6rem; }
        }
    </style>
</head>
<body oncontextmenu="return false;" oncopy="return false;" oncut="return false;" onselectstart="return false;" ondragstart="return false;">

    <div class="pokemon-header">
        <i class="fas fa-paw"></i>
        <h1>âš¡ HSK 3 Â· ç¬¬18è¯¾ Â· æˆ‘ç›¸ä¿¡ä»–ä»¬ä¼šåŒæ„çš„ Â· ç‰ˆæœ¬2 âš¡</h1>
        <i class="fas fa-bolt"></i>
    </div>

    <div class="timer-container">
        <span><i class="fas fa-hourglass-half"></i> Sisa Waktu</span>
        <span class="timer-box" id="timerDisplay">56:00</span>
    </div>

    <p style="text-align: center; font-size: 1.6rem; margin-bottom: 20px; font-weight: 700; background: white; display: inline-block; padding: 10px 35px; border-radius: 40px; border: 4px solid #2563eb;">âœ¨ 70 Soal Baru Â· Versi 2 âœ¨</p>

    <!-- ===== 1. åˆ¤æ–­å¯¹é”™ (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-check-circle"></i> åˆ¤æ–­å¯¹é”™ Â· 10</div>
        <div class="grid-2" id="benarSalahContainer"></div>
    </div>

    <!-- ===== 2. LISTENING (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-headphones-alt"></i> å¬åŠ›ç‰¹è®­ Â· 10</div>
        <div class="grid-2" id="listening-soal"></div>
    </div>

    <!-- ===== 3. PILIHAN GANDA (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-question-circle"></i>  PILIHAN GANDA Â· 10</div>
        <div id="pilihan-ganda-container"></div>
    </div>

    <!-- ===== 4. ISIAN HANZI (10) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-pencil-alt"></i>  ISIAN HANZI Â· 10</div>
        <div id="bankKataIsian" class="bank-kata-container"></div>
        <div id="soal-isian-container" class="grid-2"></div>
    </div>

    <!-- ===== 5. MENGETIK HANZI (PINYIN) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-keyboard"></i>  TULIS HANZI (pinyin) Â· 10</div>
        <div id="ketik-hanzi-grid" class="grid-2"></div>
    </div>

    <!-- ===== 6. INDONESIA â†’ HANZI ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-language"></i>  INDONESIA â†’ HANZI Â· 10</div>
        <div id="indo-hanzi-grid" class="grid-2"></div>
    </div>

    <!-- ===== 7. MENJODOHKAN DRAG & DROP (2 set) ===== -->
    <div class="section-card">
        <div class="section-title"><i class="fas fa-link"></i>  JODOHKAN Â· set 1 (5) â€” tarik kiri ke kanan</div>
        <div id="pasangan-set1" class="pasangan-container"></div>
        <div style="margin: 30px 0;"></div>
        <div class="section-title"><i class="fas fa-link"></i>  JODOHKAN Â· set 2 (5) â€” tarik kiri ke kanan</div>
        <div id="pasangan-set2" class="pasangan-container"></div>
    </div>

    <button id="submitGlobalBtn" class="btn-utama"><i class="fas fa-paper-plane"></i> KIRIM SEMUA JAWABAN</button>
    <div id="laporanGlobal" class="laporan-akhir" style="display: none;"></div>
    <footer><i class="fas fa-pokeball"></i>  HSK 3 Â· 70 Soal Baru  <i class="fas fa-pokeball"></i></footer>

    <div id="dragGhost" class="drag-ghost"></div>

    <script>
        (function() {
            // ==================== FUNGSI ACAK ====================
            function shuffleArray(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            // ========== 1. åˆ¤æ–­å¯¹é”™ (10 soal baru) ==========
            const bsDataOriginal = [
                { kalimat: "æœ‹å‹å‘è€å‘¨å€Ÿäº†äº”ä¸‡å—é’±ï¼Œæ‰“ç®—åœ¨åŒ»é™¢å‰é¢ä¹°æˆ¿å­ã€‚", pernyataan: "æœ‹å‹è¦å€Ÿåä¸‡å—é’±ã€‚", jawaban: "S" },
                { kalimat: "å°æ˜æƒ³ä¹°ä¸€åªç‹—ï¼Œå› ä¸ºå®ƒçš„çœ¼ç›å¤§å¤§çš„ï¼Œå˜´å°å°çš„ã€‚", pernyataan: "å°æ˜æƒ³ä¹°ä¸€åªçŒ«ã€‚", jawaban: "S" },
                { kalimat: "å¦ˆå¦ˆè§‰å¾—å°æ˜ä¸èƒ½ç…§é¡¾å¥½ç‹—ï¼Œå› ä¸ºè¿™æ®µæ—¶é—´ä»–è¿è‡ªå·±çš„è¡£æœéƒ½æ²¡æ´—ã€‚", pernyataan: "å¦ˆå¦ˆè®¤ä¸ºå°æ˜èƒ½ç…§é¡¾å¥½ç‹—ã€‚", jawaban: "S" },
                { kalimat: "å­¦ç”Ÿé€‰æ‹©è¿™ä¸ªå…¬å¸æ˜¯å› ä¸ºå®ƒå¾ˆæœ‰åï¼Œè€Œä¸”å·¥ä½œç¯å¢ƒå¥½ã€‚", pernyataan: "å­¦ç”Ÿå› ä¸ºå…¬å¸å·¥èµ„é«˜è€Œé€‰æ‹©å®ƒã€‚", jawaban: "S" },
                { kalimat: "ç»ç†è¯´åšè¿™ä¸ªå·¥ä½œæœ‰ç‚¹å„¿ç´¯ï¼Œéœ€è¦ç»å¸¸å»å¤–åœ°ã€‚", pernyataan: "ç»ç†è¯´è¿™ä¸ªå·¥ä½œå¾ˆè½»æ¾ã€‚", jawaban: "S" },
                { kalimat: "å­¦ç”Ÿç›¸ä¿¡åªè¦ä»–æ„¿æ„ï¼Œå®¶äººå°±ä¼šåŒæ„ä»–æ¥è¿™ä¸ªå…¬å¸ã€‚", pernyataan: "å­¦ç”Ÿè§‰å¾—å®¶äººä¸ä¼šåŒæ„ã€‚", jawaban: "S" },
                { kalimat: "å…³äºè¿™ä¸ªå·¥ä½œï¼Œå­¦ç”Ÿè¯´æ²¡æœ‰é—®é¢˜ã€‚", pernyataan: "å­¦ç”Ÿé—®äº†å‡ ä¸ªé—®é¢˜ã€‚", jawaban: "S" },
                { kalimat: "ä¸åŒçš„å›½å®¶æœ‰ä¸åŒçš„æ–‡åŒ–ï¼Œæ¯ç§æ–‡åŒ–éƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹ã€‚", pernyataan: "æ‰€æœ‰å›½å®¶çš„æ–‡åŒ–éƒ½ä¸€æ ·ã€‚", jawaban: "S" },
                { kalimat: "åˆ°äº†ä¸€ä¸ªæ–°ç¯å¢ƒï¼Œäººä»¬ä¼šè§‰å¾—ä»€ä¹ˆéƒ½æ–°é²œï¼Œè€Œä¸”ä¼šæœ‰ç‚¹å¥‡æ€ªã€‚", pernyataan: "æ–°ç¯å¢ƒè®©äººè§‰å¾—ä¸æ–°é²œã€‚", jawaban: "S" },
                { kalimat: "åªè¦ç»è¿‡ä¸€æ®µæ—¶é—´ï¼Œäººä»¬å°±ä¼šæ…¢æ…¢ä¹ æƒ¯æ–°ç¯å¢ƒã€‚", pernyataan: "äººä»¬æ°¸è¿œä¸ä¼šä¹ æƒ¯æ–°ç¯å¢ƒã€‚", jawaban: "S" }
            ];
            let bsData = shuffleArray([...bsDataOriginal]);
            let bsUserAnswers = new Array(10).fill(null);
            const bsContainer = document.getElementById('benarSalahContainer');
            bsContainer.innerHTML = bsData.map((item, idx) => {
                return `<div class="soal-item" data-bs="${idx}">
                    <p style="font-size:1.2rem; background:#e0f7fa; padding:10px; border-radius:20px;"><i class="fas fa-quote-left"></i> ${item.kalimat}</p>
                    <p style="font-size:1.1rem; font-weight:600; margin-top:12px;">ğŸ“Œ Pernyataan: ${item.pernyataan}</p>
                    <div class="benar-salah-container" id="bs-${idx}">
                        <span class="btn-bs" onclick="pilihBS(${idx}, 'B')" id="bs-${idx}-B"><i class="fas fa-check-circle"></i> BENAR</span>
                        <span class="btn-bs" onclick="pilihBS(${idx}, 'S')" id="bs-${idx}-S"><i class="fas fa-times-circle"></i> SALAH</span>
                    </div>
                </div>`;
            }).join('');
            window.pilihBS = function(idx, pilih) {
                bsUserAnswers[idx] = pilih;
                document.getElementById(`bs-${idx}-B`).classList.remove('selected');
                document.getElementById(`bs-${idx}-S`).classList.remove('selected');
                document.getElementById(`bs-${idx}-${pilih}`).classList.add('selected');
            };

            // ========== 2. LISTENING (10 percakapan baru) ==========
            const listeningOriginal = [
                { percakapan: ["å¥³ï¼šä½ å‘è°å€Ÿé’±ï¼Ÿ", "ç”·ï¼šæˆ‘å‘è€å‘¨å€Ÿäº†äº”ä¸‡ï¼Œæ‰“ç®—ä¹°æˆ¿ã€‚", "å¥³ï¼šæ‰“ç®—åœ¨å“ªå„¿ä¹°ï¼Ÿ", "ç”·ï¼šå°±åœ¨åŒ»é™¢å‰é¢ã€‚"], pertanyaan: "ç”·çš„æ‰“ç®—åœ¨å“ªå„¿ä¹°æˆ¿ï¼Ÿ", opsi: ["A. å­¦æ ¡æ—è¾¹", "B. åŒ»é™¢å‰é¢", "C. å…¬å¸é™„è¿‘", "D. ç«è½¦ç«™æ—è¾¹"], jawaban: "B" },
                { percakapan: ["ç”·ï¼šå¦ˆå¦ˆï¼Œä½ çœ‹é‚£åªç‹—å¤šå¯çˆ±ï¼Œæˆ‘ä»¬ä¹°å›å»å§ã€‚", "å¥³ï¼šä¹°å›å»è°ç…§é¡¾å®ƒï¼Ÿä½ èƒ½ç…§é¡¾å¥½å®ƒå—ï¼Ÿ", "ç”·ï¼šåªè¦ä½ ç»™æˆ‘ä¹°ï¼Œæˆ‘å°±èƒ½ç…§é¡¾å¥½ã€‚"], pertanyaan: "å°æ˜ä¸ºä»€ä¹ˆè§‰å¾—è‡ªå·±èƒ½ç…§é¡¾å¥½ç‹—ï¼Ÿ", opsi: ["A. å› ä¸ºä»–æœ‰æ—¶é—´", "B. å› ä¸ºä»–å–œæ¬¢ç‹—", "C. å› ä¸ºå¦ˆå¦ˆä¼šå¸®å¿™", "D. å› ä¸ºä»–ç›¸ä¿¡è‡ªå·±"], jawaban: "D" },
                { percakapan: ["å¥³ï¼šä½ ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬å…¬å¸ï¼Ÿ", "ç”·ï¼šè´µå…¬å¸ä¸ä½†å¾ˆæœ‰åï¼Œè€Œä¸”å·¥ä½œç¯å¢ƒå¥½ã€‚", "å¥³ï¼šè¿™ä¸ªå·¥ä½œæœ‰ç‚¹ç´¯ï¼Œéœ€è¦ç»å¸¸å»å¤–åœ°ï¼Œä½ å®¶äººåŒæ„å—ï¼Ÿ", "ç”·ï¼šåªè¦æˆ‘æ„¿æ„ï¼Œæˆ‘ç›¸ä¿¡ä»–ä»¬ä¼šåŒæ„çš„ã€‚"], pertanyaan: "å­¦ç”Ÿè§‰å¾—å®¶äººä¼šåŒæ„å—ï¼Ÿ", opsi: ["A. ä¸åŒæ„", "B. ä¼šåŒæ„", "C. è¿˜æ²¡é—®", "D. ä¸çŸ¥é“"], jawaban: "B" },
                { percakapan: ["ç”·ï¼šå…³äºè¿™ä¸ªå·¥ä½œï¼Œä½ è¿˜æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ", "å¥³ï¼šæ²¡æœ‰äº†ï¼Œè°¢è°¢æ‚¨ç»™æˆ‘è¿™ä¸ªæœºä¼šã€‚"], pertanyaan: "å¥³çš„æœ‰æ²¡æœ‰é—®é¢˜ï¼Ÿ", opsi: ["A. æœ‰", "B. æ²¡æœ‰", "C. ä¸å¥½æ„æ€é—®", "D. è¿˜æ²¡æƒ³å¥½"], jawaban: "B" },
                { percakapan: ["å¥³ï¼šåˆ°äº†ä¸€ä¸ªæ–°ç¯å¢ƒï¼Œä½ ä¼šè§‰å¾—å¥‡æ€ªå—ï¼Ÿ", "ç”·ï¼šåˆšå¼€å§‹ä¼šï¼Œä½†æ˜¯åªè¦ç»è¿‡ä¸€æ®µæ—¶é—´ï¼Œå°±ä¼šæ…¢æ…¢ä¹ æƒ¯ã€‚"], pertanyaan: "ç”·çš„è§‰å¾—æ–°ç¯å¢ƒæ€ä¹ˆæ ·ï¼Ÿ", opsi: ["A. ä¸€ç›´å¥‡æ€ª", "B. é©¬ä¸Šä¹ æƒ¯", "C. æ…¢æ…¢ä¹ æƒ¯", "D. ä¸ä¹ æƒ¯"], jawaban: "C" },
                { percakapan: ["ç”·ï¼šä½ è¿˜æ²¡åƒé¥±å•Šï¼Ÿ", "å¥³ï¼šåªè¦ä¸œè¥¿å¥½åƒï¼Œæˆ‘å°±å¯ä»¥åƒå¾—ç‰¹åˆ«å¤šã€‚", "ç”·ï¼šä½ åƒå¾—è¿™ä¹ˆå¤šï¼Œå°å¿ƒæ‰¾ä¸åˆ°ç”·æœ‹å‹ã€‚", "å¥³ï¼šå…³äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸æ‹…å¿ƒï¼Œå› ä¸ºæˆ‘å·²ç»æœ‰ç”·æœ‹å‹äº†ã€‚"], pertanyaan: "å¥³çš„ä¸ºä»€ä¹ˆä¸æ‹…å¿ƒåƒå¾—å¤šï¼Ÿ", opsi: ["A. å¥¹ä¸æ€•èƒ–", "B. å¥¹å·²ç»ç»“å©šäº†", "C. å¥¹æœ‰ç”·æœ‹å‹äº†", "D. å¥¹ä¸åœ¨ä¹"], jawaban: "C" },
                { percakapan: ["å¥³ï¼šä½ å–œæ¬¢çœ‹å“ªç§ç”µå½±ï¼Ÿ", "ç”·ï¼šåªè¦æ˜¯ä¸­å›½çš„ï¼Œæˆ‘å°±å–œæ¬¢ã€‚", "å¥³ï¼šæˆ‘å®¶æœ‰å¾ˆå¤šå…³äºä¸­å›½æ–‡åŒ–çš„ç”µå½±å…‰ç›˜ã€‚", "ç”·ï¼šå¤ªå¥½äº†ï¼Œé‚£ä½ å€Ÿç»™æˆ‘ä¸€äº›å§ã€‚"], pertanyaan: "ç”·çš„å–œæ¬¢ä»€ä¹ˆç”µå½±ï¼Ÿ", opsi: ["A. ç¾å›½ç”µå½±", "B. ä¸­å›½ç”µå½±", "C. æ³•å›½ç”µå½±", "D. æ—¥æœ¬ç”µå½±"], jawaban: "B" },
                { percakapan: ["ç”·ï¼šå‘¨æœ«æˆ‘ä»¬å»å“ªå„¿ç©å„¿ï¼Ÿ", "å¥³ï¼šåªè¦å¤©æ°”å¥½ï¼Œæˆ‘ä»¬å°±å»çˆ¬å±±ã€‚", "ç”·ï¼šå¥½å•Šï¼Œè¿™æ®µæ—¶é—´å¤ªå¿™äº†ï¼Œå¿™å¾—æ²¡æœ‰æœºä¼šé”»ç‚¼ã€‚", "å¥³ï¼šç»å¸¸çˆ¬å±±å¯¹èº«ä½“å¥½ã€‚"], pertanyaan: "ä»–ä»¬ä»€ä¹ˆæ—¶å€™å»çˆ¬å±±ï¼Ÿ", opsi: ["A. ä»Šå¤©", "B. æ˜å¤©", "C. å¤©æ°”å¥½æ—¶", "D. ä¸‹ä¸ªæœˆ"], jawaban: "C" },
                { percakapan: ["å¥³ï¼šä½ æœ€è¿‘æ€ä¹ˆæ€»æ˜¯è¿Ÿåˆ°ï¼Ÿ", "ç”·ï¼šæˆ‘ä¹Ÿä¸æƒ³è¿Ÿåˆ°ï¼Œä½†æ˜¯å®¶å¤ªè¿œäº†ã€‚", "å¥³ï¼šä½ åªè¦æ—©èµ·ä¸€ç‚¹å„¿ï¼Œå°±ä¸ä¼šè¿Ÿåˆ°ã€‚", "ç”·ï¼šå¥½ï¼Œæˆ‘ç›¸ä¿¡æˆ‘ä¼šæ…¢æ…¢ä¹ æƒ¯çš„ã€‚"], pertanyaan: "ç”·çš„ä¸ºä»€ä¹ˆè¿Ÿåˆ°ï¼Ÿ", opsi: ["A. èµ·åºŠæ™š", "B. å®¶è¿œ", "C. å µè½¦", "D. ç”Ÿç—…"], jawaban: "B" },
                { percakapan: ["ç”·ï¼šè¿™åªç‹—çš„çœ¼ç›å¤§å¤§çš„ï¼Œå˜´å°å°çš„ï¼ŒçœŸå¯çˆ±ã€‚", "å¥³ï¼šæ˜¯å•Šï¼ŒåŠ¨ç‰©å’Œå°å­©å„¿ä¸€æ ·ï¼Œéƒ½éœ€è¦äººç…§é¡¾ã€‚"], pertanyaan: "å¥³çš„è§‰å¾—åŠ¨ç‰©æ€ä¹ˆæ ·ï¼Ÿ", opsi: ["A. å¾ˆå¯çˆ±", "B. éœ€è¦ç…§é¡¾", "C. å¾ˆéº»çƒ¦", "D. å¾ˆè„"], jawaban: "B" }
            ];
            let listeningData = shuffleArray([...listeningOriginal]);
            let listeningUserAnswers = new Array(10).fill(null);
            const listeningDiv = document.getElementById('listening-soal');
            listeningDiv.innerHTML = listeningData.map((item, idx) => {
                let dialogHTML = '<div class="dialog-box">';
                item.percakapan.forEach(baris => dialogHTML += `<div class="dialog-line">${baris}</div>`);
                dialogHTML += '</div>';
                dialogHTML += `<div class="pertanyaan">${idx+1}. ${item.pertanyaan}</div><div class="opsi-container">`;
                item.opsi.forEach((opsi, opsiIdx) => {
                    const huruf = String.fromCharCode(65+opsiIdx);
                    dialogHTML += `<span class="btn-opsi" onclick="pilihListening(${idx}, '${huruf}')" id="listen-${idx}-${huruf}">${opsi}</span>`;
                });
                dialogHTML += '</div>';
                return `<div class="soal-item" data-listen="${idx}">${dialogHTML}</div>`;
            }).join('');
            window.pilihListening = function(idx, huruf) {
                listeningUserAnswers[idx] = huruf;
                document.querySelector(`[data-listen="${idx}"]`).querySelectorAll('.btn-opsi').forEach(btn => btn.classList.remove('selected'));
                document.getElementById(`listen-${idx}-${huruf}`).classList.add('selected');
            };

            // ========== 3. PILIHAN GANDA (10 soal baru) ==========
            const pgOriginal = [
                { soal: "â€œåªè¦â€¦â€¦å°±â€¦â€¦â€ ä¸­çš„â€œåªè¦â€å¼•å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿ", a: "ç»“æœ", b: "æ¡ä»¶", c: "åŸå› ", d: "ç›®çš„", jawab: "b" },
                { soal: "â€œå…³äºâ€ åé¢å¯ä»¥æ¥ä»€ä¹ˆï¼Ÿ", a: "åŠ¨è¯", b: "å½¢å®¹è¯", c: "åè¯", d: "å‰¯è¯", jawab: "c" },
                { soal: "â€œä¸ä½†â€¦â€¦è€Œä¸”â€¦â€¦â€ è¡¨ç¤ºä»€ä¹ˆå…³ç³»ï¼Ÿ", a: "è½¬æŠ˜", b: "å› æœ", c: "é€’è¿›", d: "é€‰æ‹©", jawab: "c" },
                { soal: "â€œå‘â€ åœ¨å¥å­â€œæˆ‘å‘ä½ å€Ÿé’±â€ä¸­çš„æ„æ€æ˜¯ï¼Ÿ", a: "æ–¹å‘", b: "ä»", c: "å¯¹", d: "åˆ°", jawab: "c" },
                { soal: "â€œä¸‡â€ æ˜¯æ•°å­—å¤šå°‘ï¼Ÿ", a: "ä¸€åƒ", b: "ä¸€ä¸‡", c: "åä¸‡", d: "ç™¾ä¸‡", jawab: "b" },
                { soal: "â€œä¸€åªç‹—â€ä¸­çš„â€œåªâ€æ˜¯ä»€ä¹ˆè¯ï¼Ÿ", a: "åè¯", b: "åŠ¨è¯", c: "é‡è¯", d: "å½¢å®¹è¯", jawab: "c" },
                { soal: "â€œåŠ¨ç‰©â€ ä¸åŒ…æ‹¬ä»¥ä¸‹å“ªé¡¹ï¼Ÿ", a: "ç‹—", b: "çŒ«", c: "äºº", d: "é¸Ÿ", jawab: "c" },
                { soal: "â€œä¸€æ®µæ—¶é—´â€ä¸­çš„â€œæ®µâ€æ˜¯ä»€ä¹ˆè¯ï¼Ÿ", a: "åè¯", b: "é‡è¯", c: "åŠ¨è¯", d: "å‰¯è¯", jawab: "b" },
                { soal: "â€œå¥‡æ€ªâ€ çš„æ„æ€æ˜¯ï¼Ÿ", a: "æ™®é€š", b: "ç‰¹æ®Š", c: "å¥‡æ€ª", d: "æ¼‚äº®", jawab: "c" },
                { soal: "â€œåœ°â€ åœ¨â€œæ…¢æ…¢åœ°ä¹ æƒ¯â€ä¸­çš„ä½œç”¨æ˜¯ï¼Ÿ", a: "è¿æ¥çŠ¶è¯­å’ŒåŠ¨è¯", b: "è¡¨ç¤ºåœ°ç‚¹", c: "è¡¨ç¤ºæ—¶é—´", d: "è¡¨ç¤ºæ–¹å¼", jawab: "a" }
            ];
            let pgData = shuffleArray([...pgOriginal]);
            let pgUserAnswers = new Array(10).fill(null);
            const pgContainer = document.getElementById('pilihan-ganda-container');
            pgContainer.innerHTML = pgData.map((item, idx) => {
                return `<div class="soal-item" data-pg="${idx}">
                    <p style="font-size:1.3rem;font-weight:700;">${idx+1}. ${item.soal}</p>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:15px;">
                        <span class="btn-pilih" onclick="pilihPG(${idx},'a',this)">A. ${item.a}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'b',this)">B. ${item.b}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'c',this)">C. ${item.c}</span>
                        <span class="btn-pilih" onclick="pilihPG(${idx},'d',this)">D. ${item.d}</span>
                    </div>
                </div>`;
            }).join('');
            window.pilihPG = function(idx, pilih, el) {
                pgUserAnswers[idx] = pilih;
                const parent = el.closest('.soal-item');
                parent.querySelectorAll('.btn-pilih').forEach(b => b.classList.remove('selected'));
                el.classList.add('selected');
            };

            // ========== 4. ISIAN HANZI (10 soal baru) ==========
            const isianSoalOriginal = [
                { kalimat: "æˆ‘æ‰“____ä¹°æˆ¿å­ï¼Œè¿˜å·®äº”ä¸‡å—é’±ã€‚", jawab: "ç®—" }, // æ‰“ç®—
                { kalimat: "ä½ ____è°å€Ÿçš„é’±ï¼Ÿ", jawab: "å‘" },
                { kalimat: "è¿™____ç‹—å¾ˆå¯çˆ±ã€‚", jawab: "åª" },
                { kalimat: "å¥¹çš„____å·´å¾ˆå°ã€‚", jawab: "å˜´" },
                { kalimat: "åŠ¨____ä¹Ÿéœ€è¦äººç…§é¡¾ã€‚", jawab: "ç‰©" },
                { kalimat: "è¿‡äº†ä¸€____æ—¶é—´ï¼Œä»–å°±ä¹ æƒ¯äº†ã€‚", jawab: "æ®µ" },
                { kalimat: "è¿™å®¶å…¬å¸å¾ˆæœ‰____ã€‚", jawab: "å" }, // æœ‰å
                { kalimat: "æˆ‘ç›¸ä¿¡ä»–ä»¬ä¼šåŒ____çš„ã€‚", jawab: "æ„" },
                { kalimat: "å…³äºè¿™ä¸ªé—®____ï¼Œæˆ‘ä»¬ä»¥åå†è°ˆã€‚", jawab: "é¢˜" },
                { kalimat: "æ¯ä¸ªå›½____éƒ½æœ‰è‡ªå·±çš„æ–‡åŒ–ã€‚", jawab: "å®¶" }
            ];
            let isianSoal = shuffleArray([...isianSoalOriginal]);
            let bankKataIsian = ["ç®—","å‘","åª","å˜´","ç‰©","æ®µ","å","æ„","é¢˜","å®¶","åœ°","ç‰¹","å¥‡","æ€ª","ä¸‡"];
            let bankKataShuffled = shuffleArray([...bankKataIsian]);
            const bankContainer = document.getElementById('bankKataIsian');
            bankContainer.innerHTML = '';
            bankKataShuffled.forEach(kata => {
                const btn = document.createElement('span');
                btn.className = 'btn-kata';
                btn.textContent = kata;
                btn.setAttribute('data-kata', kata);
                btn.onclick = function() {
                    const active = document.activeElement;
                    if (active && active.classList.contains('input-isian')) {
                        active.value = kata;
                    } else {
                        alert('Klik pada kotak input yang ingin diisi terlebih dahulu.');
                    }
                };
                bankContainer.appendChild(btn);
            });
            const isianContainer = document.getElementById('soal-isian-container');
            isianContainer.innerHTML = '';
            isianSoal.forEach((item, idx) => {
                const div = document.createElement('div');
                div.className = 'soal-item soal-isian';
                div.setAttribute('data-isian', idx);
                div.innerHTML = `<p style="font-size:1.3rem;">${idx+1}. ${item.kalimat.replace('____','______')}</p>
                                <input class="input-kotak input-isian" type="text" id="isian-${idx}" data-jawaban="${item.jawab}" placeholder="ketik hanzi" autocomplete="off">`;
                isianContainer.appendChild(div);
            });

            // ========== 5. MENGETIK HANZI (pinyin baru) ==========
            const hanziOriginal = [
                { pinyin: "dÇsuÃ n", arti: "berencana", hanzi: "æ‰“ç®—" },
                { pinyin: "zhÇ", arti: "hanya / (penghitung hewan)", hanzi: "åª" },
                { pinyin: "dÃ²ngwÃ¹", arti: "hewan", hanzi: "åŠ¨ç‰©" },
                { pinyin: "tÃ¨diÇn", arti: "ciri khas", hanzi: "ç‰¹ç‚¹" },
                { pinyin: "qÃ­guÃ i", arti: "aneh", hanzi: "å¥‡æ€ª" },
                { pinyin: "jÄ«huÃ¬", arti: "kesempatan", hanzi: "æœºä¼š" },
                { pinyin: "guÄnyÃº", arti: "tentang", hanzi: "å…³äº" },
                { pinyin: "xiÄngxÃ¬n", arti: "percaya", hanzi: "ç›¸ä¿¡" },
                { pinyin: "tÃ³ngyÃ¬", arti: "setuju", hanzi: "åŒæ„" },
                { pinyin: "yÇ’umÃ­ng", arti: "terkenal", hanzi: "æœ‰å" }
            ];
            let hanziFromPinyin = shuffleArray([...hanziOriginal]);
            const ketikGrid = document.getElementById('ketik-hanzi-grid');
            ketikGrid.innerHTML = hanziFromPinyin.map((item, idx) => {
                return `<div class="soal-item">
                    <p style="font-size:1.2rem;"><strong>${idx+1}. ${item.pinyin}</strong> (${item.arti})</p>
                    <input class="input-kotak" type="text" id="hanziInput${idx}" placeholder="ketik hanzi" autocomplete="off">
                </div>`;
            }).join('');

            // ========== 6. INDONESIA â†’ HANZI (baru) ==========
            const indoOriginal = [
                { arti: "sepuluh ribu", hanzi: "ä¸‡" },
                { arti: "hewan", hanzi: "åŠ¨ç‰©" },
                { arti: "mulut", hanzi: "å˜´" },
                { arti: "setuju", hanzi: "åŒæ„" },
                { arti: "percaya", hanzi: "ç›¸ä¿¡" },
                { arti: "tentang", hanzi: "å…³äº" },
                { arti: "kesempatan", hanzi: "æœºä¼š" },
                { arti: "negara", hanzi: "å›½å®¶" },
                { arti: "jenis", hanzi: "ç§" },
                { arti: "ciri khas", hanzi: "ç‰¹ç‚¹" }
            ];
            let indoToHanzi = shuffleArray([...indoOriginal]);
            const indoGrid = document.getElementById('indo-hanzi-grid');
            indoGrid.innerHTML = indoToHanzi.map((item, idx) => {
                return `<div class="soal-item">
                    <p style="font-size:1.3rem;"><strong>${idx+1}. ${item.arti}</strong></p>
                    <input class="input-kotak" type="text" id="indoInput${idx}" placeholder="tulis hanzi" autocomplete="off">
                </div>`;
            }).join('');

            // ========== 7. DRAG & DROP MATCHING (2 set baru) ==========
            const set1Pairs = [
                { left: "ä½ ä¸ºä»€ä¹ˆå€Ÿé’±ï¼Ÿ", right: "æˆ‘è¦ä¹°æˆ¿å­" },
                { left: "è¿˜å·®å¤šå°‘é’±ï¼Ÿ", right: "äº”ä¸‡å—é’±" },
                { left: "ä½ æ‰“ç®—åœ¨å“ªå„¿ä¹°æˆ¿ï¼Ÿ", right: "åœ¨åŒ»é™¢å‰é¢" },
                { left: "è¿™åªç‹—æ€ä¹ˆæ ·ï¼Ÿ", right: "çœ¼ç›å¤§å¤§ï¼Œå˜´å°å°" },
                { left: "ä½ èƒ½ç…§é¡¾å¥½å®ƒå—ï¼Ÿ", right: "åªè¦ç»™æˆ‘ä¹°ï¼Œæˆ‘å°±èƒ½ç…§é¡¾" }
            ];
            const set2Pairs = [
                { left: "ä½ ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬å…¬å¸ï¼Ÿ", right: "å› ä¸ºå¾ˆæœ‰åï¼Œç¯å¢ƒå¥½" },
                { left: "è¿™ä¸ªå·¥ä½œæ€ä¹ˆæ ·ï¼Ÿ", right: "æœ‰ç‚¹å„¿ç´¯ï¼Œéœ€è¦å»å¤–åœ°" },
                { left: "ä½ å®¶äººåŒæ„å—ï¼Ÿ", right: "æˆ‘ç›¸ä¿¡ä»–ä»¬ä¼šåŒæ„" },
                { left: "å…³äºè¿™ä¸ªå·¥ä½œæœ‰é—®é¢˜å—ï¼Ÿ", right: "æ²¡æœ‰é—®é¢˜" },
                { left: "åˆ°äº†æ–°ç¯å¢ƒä¼šä¹ æƒ¯å—ï¼Ÿ", right: "æ…¢æ…¢å°±ä¼šä¹ æƒ¯" }
            ];
            let pairSet1 = {}; let pairSet2 = {};
            for (let i=0; i<5; i++) { pairSet1[i] = null; pairSet2[i] = null; }

            // Drag state
            let dragActive = false, draggedElement = null, draggedSet = null, draggedLeftIdx = null;
            let ghost = document.getElementById('dragGhost');

            function renderDragDropSet(setId, pairs, containerId) {
                let leftItems = pairs.map(p => p.left);
                let rightItems = pairs.map(p => p.right);
                leftItems = shuffleArray(leftItems);
                rightItems = shuffleArray(rightItems);
                const cont = document.getElementById(containerId);
                cont.innerHTML = `<div class="kolom-pasangan" id="left-${setId}">
                                    <h3 style="background:#ffb347;padding:10px;border-radius:30px;">â¬…ï¸ Kiri (tarik)</h3>
                                    <div id="left-${setId}-list"></div>
                                  </div>
                                  <div class="kolom-pasangan" id="right-${setId}">
                                    <h3 style="background:#6ac46a;padding:10px;border-radius:30px;">â¡ï¸ Kanan (lepas)</h3>
                                    <div id="right-${setId}-list"></div>
                                  </div>`;
                const leftList = document.getElementById(`left-${setId}-list`);
                const rightList = document.getElementById(`right-${setId}-list`);
                window[`pairMap${setId}`] = {};
                pairs.forEach(p => { window[`pairMap${setId}`][p.left] = p.right; });
                leftItems.forEach((txt, i) => {
                    let div = document.createElement('div');
                    div.className = 'pair-item-left';
                    div.id = `left-${setId}-${i}`;
                    div.innerHTML = txt;
                    div.setAttribute('data-left-text', txt);
                    div.setAttribute('data-left-idx', i);
                    div.setAttribute('data-set', setId);
                    div.addEventListener('pointerdown', dragStartHandler);
                    leftList.appendChild(div);
                });
                rightItems.forEach((txt, i) => {
                    let div = document.createElement('div');
                    div.className = 'pair-item-right';
                    div.id = `right-${setId}-${i}`;
                    div.innerHTML = txt;
                    div.setAttribute('data-right-text', txt);
                    div.setAttribute('data-right-idx', i);
                    div.setAttribute('data-set', setId);
                    div.addEventListener('pointerup', dropHandler);
                    div.addEventListener('pointerenter', dragEnterHandler);
                    rightList.appendChild(div);
                });
            }

            function dragStartHandler(e) {
                e.preventDefault();
                if (dragActive) return;
                draggedElement = this;
                draggedSet = this.getAttribute('data-set');
                draggedLeftIdx = parseInt(this.getAttribute('data-left-idx'));
                ghost.textContent = this.textContent;
                ghost.style.display = 'block';
                updateGhostPosition(e);
                this.classList.add('dragging');
                dragActive = true;
                window.addEventListener('pointermove', dragMoveHandler);
                window.addEventListener('pointerup', dragEndHandler);
                window.addEventListener('pointercancel', dragEndHandler);
            }
            function dragMoveHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                updateGhostPosition(e);
            }
            function dragEnterHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
            }
            function dropHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                const rightSet = this.getAttribute('data-set');
                const rightText = this.getAttribute('data-right-text');
                if (rightSet !== draggedSet) { dragEndHandler(e); return; }
                const store = (draggedSet === 's1') ? pairSet1 : pairSet2;
                const prevRightText = store[draggedLeftIdx];
                if (prevRightText) {
                    draggedElement.classList.remove('paired');
                    const prevRightEls = document.querySelectorAll(`#right-${draggedSet} .pair-item-right`);
                    prevRightEls.forEach(el => {
                        if (el.getAttribute('data-right-text') === prevRightText) el.classList.remove('paired');
                    });
                }
                const rightEls = document.querySelectorAll(`#right-${draggedSet} .pair-item-right`);
                rightEls.forEach(el => {
                    if (el.getAttribute('data-right-text') === rightText) {
                        el.classList.remove('paired');
                        for (let key in store) {
                            if (store[key] === rightText) {
                                store[key] = null;
                                const leftEl = document.getElementById(`left-${draggedSet}-${key}`);
                                if (leftEl) leftEl.classList.remove('paired');
                            }
                        }
                    }
                });
                store[draggedLeftIdx] = rightText;
                draggedElement.classList.add('paired');
                this.classList.add('paired');
                dragEndHandler(e);
            }
            function updateGhostPosition(e) {
                let x, y;
                if (e.touches) {
                    x = e.touches[0].clientX;
                    y = e.touches[0].clientY;
                } else {
                    x = e.clientX;
                    y = e.clientY;
                }
                ghost.style.left = x + 'px';
                ghost.style.top = y + 'px';
            }
            function dragEndHandler(e) {
                if (!dragActive) return;
                e.preventDefault();
                ghost.style.display = 'none';
                if (draggedElement) draggedElement.classList.remove('dragging');
                window.removeEventListener('pointermove', dragMoveHandler);
                window.removeEventListener('pointerup', dragEndHandler);
                window.removeEventListener('pointercancel', dragEndHandler);
                dragActive = false;
                draggedElement = null;
                draggedSet = null;
                draggedLeftIdx = null;
            }

            renderDragDropSet('s1', set1Pairs, 'pasangan-set1');
            renderDragDropSet('s2', set2Pairs, 'pasangan-set2');

            // ========== TIMER ==========
            const TOTAL_SOAL = 70;
            const TIME_MINUTES = Math.floor(TOTAL_SOAL * 0.8);
            let timeLeft = TIME_MINUTES * 60;
            const timerDisplay = document.getElementById('timerDisplay');
            let timerInterval = setInterval(function() {
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "00:00";
                    document.getElementById('submitGlobalBtn').click();
                } else {
                    timeLeft--;
                    let minutes = Math.floor(timeLeft / 60);
                    let seconds = timeLeft % 60;
                    timerDisplay.textContent = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
                }
            }, 1000);

            // ========== EVALUASI GLOBAL (target 80%) ==========
            window.evaluasiGlobal = function() {
                let totalBenar = 0;
                const totalSoal = 70;

                // 1. åˆ¤æ–­å¯¹é”™
                for (let i=0; i<10; i++) {
                    const user = bsUserAnswers[i];
                    const correct = bsData[i].jawaban;
                    const parent = document.querySelector(`[data-bs="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-bs');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            const selectedBtn = document.getElementById(`bs-${i}-${user}`);
                            if (user === correct) { totalBenar++; selectedBtn.classList.add('benar'); }
                            else selectedBtn.classList.add('salah');
                        }
                    }
                }

                // 2. Listening
                for (let i=0; i<10; i++) {
                    const user = listeningUserAnswers[i];
                    const correct = listeningData[i].jawaban;
                    const parent = document.querySelector(`[data-listen="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-opsi');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            const selectedBtn = document.getElementById(`listen-${i}-${user}`);
                            if (user === correct) { totalBenar++; selectedBtn.classList.add('benar'); }
                            else selectedBtn.classList.add('salah');
                        }
                    }
                }

                // 3. Pilihan Ganda
                for (let i=0; i<10; i++) {
                    const user = pgUserAnswers[i];
                    const correct = pgData[i].jawab;
                    const parent = document.querySelector(`[data-pg="${i}"]`);
                    if (parent) {
                        const btns = parent.querySelectorAll('.btn-pilih');
                        btns.forEach(b => b.classList.remove('benar','salah'));
                        if (user) {
                            btns.forEach(b => {
                                if (b.innerText.startsWith(user.toUpperCase()+'.')) {
                                    if (user === correct) { totalBenar++; b.classList.add('benar'); }
                                    else b.classList.add('salah');
                                }
                            });
                        }
                    }
                }

                // 4. Isian Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`isian-${i}`);
                    if (inp) {
                        inp.classList.remove('benar','salah');
                        const userAns = inp.value.trim();
                        const correct = inp.dataset.jawaban;
                        if (userAns === correct) { totalBenar++; inp.classList.add('benar'); }
                        else if (userAns !== '') inp.classList.add('salah');
                    }
                }

                // 5. Mengetik Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`hanziInput${i}`);
                    const correct = hanziFromPinyin[i].hanzi;
                    inp.classList.remove('benar','salah');
                    if (inp.value.trim() === correct) { totalBenar++; inp.classList.add('benar'); }
                    else if (inp.value.trim() !== '') inp.classList.add('salah');
                }

                // 6. Indonesia â†’ Hanzi
                for (let i=0; i<10; i++) {
                    const inp = document.getElementById(`indoInput${i}`);
                    const correct = indoToHanzi[i].hanzi;
                    inp.classList.remove('benar','salah');
                    if (inp.value.trim() === correct) { totalBenar++; inp.classList.add('benar'); }
                    else if (inp.value.trim() !== '') inp.classList.add('salah');
                }

                // 7. Menjodohkan set1
                for (let leftIdx=0; leftIdx<5; leftIdx++) {
                    const leftEl = document.getElementById(`left-s1-${leftIdx}`);
                    if (!leftEl) continue;
                    const leftText = leftEl.getAttribute('data-left-text');
                    const rightText = pairSet1[leftIdx];
                    leftEl.classList.remove('benar','salah');
                    if (rightText) {
                        const correctRight = window.pairMaps1[leftText];
                        const rightEls = document.querySelectorAll(`#right-s1 .pair-item-right`);
                        rightEls.forEach(el => el.classList.remove('benar','salah'));
                        if (rightText === correctRight) { 
                            totalBenar++; 
                            leftEl.classList.add('benar'); 
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('benar');
                            });
                        } else {
                            leftEl.classList.add('salah');
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('salah');
                            });
                        }
                    }
                }
                // set2
                for (let leftIdx=0; leftIdx<5; leftIdx++) {
                    const leftEl = document.getElementById(`left-s2-${leftIdx}`);
                    if (!leftEl) continue;
                    const leftText = leftEl.getAttribute('data-left-text');
                    const rightText = pairSet2[leftIdx];
                    leftEl.classList.remove('benar','salah');
                    if (rightText) {
                        const correctRight = window.pairMaps2[leftText];
                        const rightEls = document.querySelectorAll(`#right-s2 .pair-item-right`);
                        rightEls.forEach(el => el.classList.remove('benar','salah'));
                        if (rightText === correctRight) { 
                            totalBenar++; 
                            leftEl.classList.add('benar'); 
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('benar');
                            });
                        } else {
                            leftEl.classList.add('salah');
                            rightEls.forEach(el => {
                                if (el.getAttribute('data-right-text') === rightText) el.classList.add('salah');
                            });
                        }
                    }
                }

                const persen = (totalBenar / totalSoal * 100).toFixed(1);
                const lulus = persen >= 80 ? 'ğŸ‰ LULUS (â‰¥80%)' : 'âŒ BELUM LULUS (target 80%)';
                const laporanDiv = document.getElementById('laporanGlobal');
                laporanDiv.style.display = 'block';
                let reviewButton = '';
                if (persen >= 80) {
                    reviewButton = '<button id="reviewBtn" class="btn-review" onclick="window.scrollTo({top: 0, behavior: \'smooth\'});"><i class="fas fa-search"></i> Review Soal</button>';
                }
                laporanDiv.innerHTML = `<h2><i class="fas fa-clipboard-check"></i> HASIL AKHIR</h2>
                    <p style="font-size:2.5rem; margin:20px 0;">${totalBenar} / ${totalSoal} = ${persen}%</p>
                    <p style="font-size:2rem; background: ${persen>=80?'#1f7a1f':'#b71c1c'}; padding:15px; border-radius:60px;">${lulus}</p>
                    ${reviewButton}`;
                clearInterval(timerInterval);
            };
            document.getElementById('submitGlobalBtn').addEventListener('click', evaluasiGlobal);
            window.pairMaps1 = {}; set1Pairs.forEach(p => { window.pairMaps1[p.left] = p.right; });
            window.pairMaps2 = {}; set2Pairs.forEach(p => { window.pairMaps2[p.left] = p.right; });
        })();
    </script>

    <script>
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('copy', e => e.preventDefault());
        document.addEventListener('cut', e => e.preventDefault());
        document.addEventListener('selectstart', e => e.preventDefault());
        document.addEventListener('dragstart', e => e.preventDefault());
    </script>
</body>
</html>